# planeBettle
移动版飞机大战  适配所有主流移动端机型


飞机大战的阶段

第一阶段 欢迎阶段

第二阶段 过渡阶段

第三阶段 运行阶段 

第四阶段 暂停阶段

第五阶段 结束阶段


   初始化游戏相关内容

1 创建HTML页面 显示游戏画面
canvas 定义canvas元素
创建画布对象 getContex()

游戏的初始化

定义出5个常量 代表5各阶段
  const START=0 欢迎
  const STARTTING=1 过渡
  const RUNNING=2 运行
  const PAUSED=3 暂停
  const GAMEOVER=4 结束
定义变量 表示游戏当前处在哪个阶段
var state=START

将当前画布的宽度和高度获取 赋值给常量

2 引入游戏所需要的图片

第一阶段需要完成内容 
1 画布中绘制背景图
自上向下的移动效果
虽然背景图片只有一张 但是在绘制时 绘制两张相同的图片 坐标值不能相同
控制两张图片同时向下移动 判断条件y是否大于画布高度 是则y重新赋值为height
2 在画布中绘制logo图片

游戏整体代码使用面向对象方式来做


给画布的click事件 完成第一阶段到第二阶段的过渡


当过渡阶段的图片数组角标等于this.sum的时候 游戏进入第三阶段

利用变量time的值对图片切换控制合适的速度

第三阶段分析
1 完成第二阶段到第三阶段的过渡

2 完成我方飞机的逻辑
 加载我方飞机图片
  初始化我方飞机数据内容
 创建我方飞机的构造器
  动画方法 两张图片不停来回切换

 创建我方飞机的对象

为canvas元素绑定移动端的触摸事件

我方飞机的射击功能 子弹
我方飞机和子弹是什么关系？
1 我方飞机是一个对象 子弹是飞机的一个属性
2 我方飞机是一个对象 子弹是另外一个对象  

加载子弹的图片
初始化子弹的数据内容
创建子弹的构造器
创建子弹对象
创建多个子弹对象 数组存储
创建用于绘制子弹的方法
创建用于移动子弹的方法
为我方飞机增加射击功能实际上就是创建子弹对象
记得从数组中删除掉超出屏幕范围的子弹对象 使用splice方法

3 完成敌方飞机的逻辑

1 敌方飞机一共具有三种
小 中 大飞机每种飞机创建一个数组来存储还是使用一个数组来存储所有的小中 大三种飞机？
选择前者
2 小 中 大飞机 每种飞机创建一个构造器还是所有飞机只创建一个构造器 
选择后者 因为彼此逻辑都差不多
3 在画面中 小 中 大飞机是只能出现一个还是多个？
 
 加载敌方飞机的图片
 小飞机一个数组
中飞机一个数组
大飞机一个数组

初始化敌方飞机的数据内容
小中大分开创建

创建敌方飞机的构造器
定义必要的属性
绘制方法
动画方法
 
创建敌方飞机的数组

定义用于创建敌方飞机的函数 for循环遍历

定义用于绘制所有敌方飞机的函数

定义用于移动所有敌方飞机的函数
定义移除敌方飞机的函数 超出范围条件的飞机




4 完成我方飞机的射击功能
5 完成打飞机的逻辑

敌方飞机被撞击的可能性 
1 子弹撞击 2 我方飞机撞击

子弹自下向上运动 敌机自上向下运动

利用碰撞检测判断出子弹和敌机的关系 然后做出对应的反应
子弹.y<敌机.y+敌机.height && 子弹.x>敌机.x-子弹.width && 子弹.x<敌机.x+敌机.width

飞机碰撞检测同理
四个临界点 
水平方向上
我方飞机在敌方飞机左侧时
enemy.x+enemy.width/2-hero.x-hero.width/2<(hero.width+enemy.width)/2 时发生碰撞

我方飞机在右侧时
hero.x+hero.width/2-enemy.x-enemy.width/2<(hero.width+enemy.width)/2 时发生碰撞

垂直方向同理
在上侧时
enemy.y+enemy.height/2-hero.y-hero.height/2<(hero.height+enemy.height)/2 时发生碰撞

在下侧时
hero.y+hero.height/2-enemy.y-enemy.height/2<(hero.height+enemy.height)/2

使用循环遍历判断敌机是否被碰撞

子弹撞击敌方飞机的的逻辑
敌方飞机被撞击后的逻辑
执行爆炸的动画
爆破动画在执行完毕后 移除敌方飞机数组
敌方飞机应该具有生命值
每次撞击生命值-1 直到敌方生命值为零时 执行爆破

子弹被撞击后的逻辑
撞击后直接移除当前子弹数组


我方飞机撞击敌方飞机的逻辑
敌方飞机被撞击后的逻辑
我方飞机撞击后的逻辑
生命值-1 不会执行爆破动画 当前的我方飞机被摧毁 生命值>0时 重新创建我方飞机 当生命值为0 时 GAMEOVER

6 加上得分和我方飞机的生命值



代码的优化

更改所有不恰当的代码逻辑

1 全局变量或全局函数的问题
存储在浏览器的内存中
使用局部变量或者使用对象的属性和方法

构造器的重复代码可以使用父级构造器来定义共有属性，使得子构造器实现继承
